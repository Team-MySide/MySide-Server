<!DOCTYPE html>
<html lang="ko">

<style type="text/css">
body{
    margin-top:20px;
    background-color: #edf0f0;    
}
div{
    text-overflow:ellipsis;
}
p{
    text-overflow:ellipsis;
}
i{
  font-size:5px;
  font-style:normal;
}

.btn-primary, 
.btn-primary:hover, 
.btn-primary:focus, 
.btn-primary:active, 
.btn-primary.active, 
.btn-primary.focus, 
.btn-primary:active, 
.btn-primary:focus, 
.btn-primary:hover, 
.open>.dropdown-toggle.btn-primary {
    background-color: #3bc0c3;
    border: 1px solid #3bc0c3;
}
.p-t-10 {
    padding-top: 10px !important;
}
.media-main a.pull-left {
    width: 100px;
}
.thumb-lg {
    height: 84px;
    width: 84px;
}
.media-main .info {
    overflow: hidden;
    color: #000;
}
.media-main .info h4 {
    padding-top: 10px;
    margin-bottom: 5px;
}
.social-links li a {
    background: #EFF0F4;
    width: 30px;
    height: 30px;
    line-height: 30px;
    text-align: center;
    display: inline-block;
    border-radius: 50%;
    -webkit-border-radius: 50%;
    color: #7A7676;
}
.tag2 {
    padding: 3px 12px;
    background: #FFF6D6;
    border-radius: 12px;
    color:#FF9635;
}
.tag1 {
    padding: 3px 12px;
    background: #E4F7FB;
    border-radius: 12px;
    color:#5091CD;
}

.modal{
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}


/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 50%;
  height: 400px;
  overflow: auto; /* Enable scroll if needed */
}

.mhead{
    font-size: 8px;
    color: #3BD7E2;
    margin:  5px;
}
.mtext{
    font-size: 10px;
    margin:  3px;
}

#modal-title{
    height: 30px;
    font-weight: bold;
    width: 100%;
  
/* The Close Button */
}

.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}

 </style>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="http://code.jquery.com/jquery.min.js"></script>
</head>   
<body style ="background-color:#F4F4F4">
<script type="text/javascript">   
$(document).ready(function() {
     init(); 
});
 function showNutrition(idx){
    var bbsreplll = $(idx).text(); 

    alert(bbsreplll);
 }

  function init(){
    
    $.ajax({
        method: "GET", // 요청 방식
        url: "/admin/list/all",
        success: function (res) { // 성공 시 호출 콜백
            console.log(res);
            $('#searchList').empty();
            for (var i = 0; i < res.data.length; i++) {
                            var tag = ` <div  class="col-sm-6" onclick="openModal(this)">`
                                      + ` <div class="panel">`
                                      + `<div class="panel-body p-t-10">`
                                      + ` <div class="media-main">`
                                      + ` <a class="pull-left" href="#">`
                                      + ` <img class="thumb-lg img-circle bx-s" style ="background-color:#${res.data[i].background_color}"`+`src=${res.data[i].img} `
                                      + `alt="" onerror="src='https://mysidebucket.s3.ap-northeast-2.amazonaws.com/02%E1%84%8E%E1%85%A2%E1%84%89%E1%85%A9_%E1%84%83%E1%85%A1%E1%86%BC%E1%84%80%E1%85%B3%E1%86%AB.png'">`
                                      + `</a>`
                                      + `<div class="pull-right btn-group-sm">`
                                      + `</div>`
                                     + ` <div class="info">`
                                      + `    <h4 id="name">${res.data[i].name}</h4>`
                                      + `    <p class="text-muted" style = "font-size:9px;">${res.data[i].title}</p>`
                                      + `</div>`
                                      + ` </div>`
                                      + ` <div class="clearfix"></div>`
                                      + ` <hr>`
                                      + `</div>`
                                       + ` </div>`
                                        + ` </div>`
                            var $li = (`${tag}`);
                            $('#searchList').append($li);//jQuery 문법

             }
        },
        error: function (data) {
            console.log("failed");
        },
        complete: function () {
            console.log('compelted');
        }

    });
       
  }

  

</script>


 
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!------ Include the above in your HEAD tag ---------->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<div class="container bootstrap snippets bootdey">
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-body p-t-0">
                    <div class="input-group">
                        <input type="text" id="keyword" name="keyword" class="form-control" placeholder="Search">
                        <span class="input-group-btn"  onclick="Search()">
                            <button type="button" style ="background-color:#3BD7E2; border-color:#3BD7E2" class="btn btn-effect-ripple btn-primary">
                              <i class="fa fa-search"></i>
                            </button>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id ="searchList" class="row">
  
    </div>
</div>
 
<div id="detailModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>

          <div id ="modal-title">상세보기</div>
          <div id ="modalList" class="row">
     </div>
 </div>

  <script>
        $(document).on('keypress', 'input,select', function (e) {
            if (e.which == 13) {
            Search();
            }
        });


        function openModal(idx){
            let name = $(idx).find('#name').text();

                console.log(name);
                // Get the modal
               var modal = document.getElementById("detailModal");
                var span = document.getElementsByClassName("close")[0];
                modal.style.display = "block";
                
                span.onclick = function() {
                modal.style.display = "none";
                }
                window.onclick = function(event) {
                    if (event.target == modal) {
                        modal.style.display = "none";
                    }
                }

                $.ajax({
                    method: "GET", // 요청 방식
                    url: "/admin/list/detail/"+name,
                    success: function (res) { // 성공 시 호출 콜백
                        console.log(res);
                        $('#modalList').empty();
                        if(res.data.length ==0) {
                            alert("음식 상세정보 미입력");
                            return ;
                        }

                        $('#modal-title').text(res.data[0].name);

                      
                        for (var i = 0; i < res.data.length; i++) {
                                        var tag =  `  <i class= "tag1">${res.data[i].status}</i>`
                                        var $li = (`${tag}`);
                                        $('#modalList').append($li);//jQuery 문법
                        }

                        for (var i = 0; i < res.data.length; i++) {
                                        var tag =     
                                                   `  <div class ="mhead">효능</div>`
                                                 + `  <div class = "mtext">${res.data[i].efficacy}</div>`
                                                 + `  <div class ="mhead">궁합</div>`
                                                 + `  <div class = "mtext">${res.data[i].combination}</div>`
                                                 + `  <div class ="mhead">고르는 법</div>`
                                                 + `  <div class = "mtext">${res.data[i].select_tip}</div>`
                                                 + `  <div class ="mhead">손질법</div>`
                                                 + `  <div class = "mtext">${res.data[i].care}</div>`

                                        var $li = (`${tag}`);
                                        $('#modalList').append($li);//jQuery 문법
                        }
                    },
                    error: function (data) {
                        console.log("failed");
                    },
                    complete: function () {
                        console.log('compelted');
                    }

                });
            
        }



        
   </script>

</body>
</html>